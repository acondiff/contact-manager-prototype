var app=angular.module("app",["ui.router","ui.bootstrap","ui.bootstrap.tpls","ui.select","ngAnimate","ngMaterial","templates","localStorage"]),moduleLoader="partials/module-load.html";app.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,n,i){t.state("contacts",{url:"/contacts",templateUrl:moduleLoader}).state("contacts.list",{url:"/list",controller:"ListCtrl",templateUrl:"contacts/list.html"}),e.otherwise("/contacts/list")}]),app.run(["$rootScope","$state","$stateParams",function(t,e,n){t.$state=e,t.$stateParams=n}]),app.controller("AppCtrl",["$scope","$rootScope","$state",function(t,e,n){e.contentLoaded=!0,t.currentAppString=e.startLocation,e.$on("$stateChangeStart",function(t,e,i,o,a){"contacts"===e.name&&n.go("contacts.list")}),e.$on("$stateChangeSuccess",function(e,n,i,o,a){t.currentAppString=n.name.split(".")[0]}),e.$on("$stateChangeError",function(e,n,i,o,a){t.currentAppString=n.name.split(".")[0]}),e.updateCurrentContacts=function(t){e.currentContacts=e.contactss[t]}}]);var ls=angular.module("localStorage",[]);ls.factory("$store",["$parse",function(t){var e="undefined"==typeof window.localStorage?void 0:window.localStorage,n=!("undefined"==typeof e||"undefined"==typeof window.JSON),i={parseValue:function(t){var e;try{e=JSON.parse(t),"undefined"==typeof e&&(e=t),"true"==e&&(e=!0),"false"==e&&(e=!1),parseFloat(e)!=e||angular.isObject(e)||(e=parseFloat(e))}catch(n){e=t}return e}},o={set:function(t,o){if(!n)try{return $.cookie(t,o),o}catch(t){console.log("Local Storage not supported, make sure you have the $.cookie supported.")}var a=JSON.stringify(o);return e.setItem(t,a),i.parseValue(a)},get:function(t){if(!n)try{return i.parseValue($.cookie(t))}catch(t){return null}var o=e.getItem(t);return i.parseValue(o)},remove:function(t){if(!n)try{return $.cookie(t,null),!0}catch(t){return!1}return e.removeItem(t),!0},bind:function(e,n,i){return i=i||"",o.get(n)||o.set(n,i),t(n).assign(e,o.get(n)),e.$watch(n,function(t){o.set(n,t)},!0),o.get(n)}};return o}]),app.controller("ListCtrl",["$scope","$rootScope","$http","$store",function(t,e,n,o){var a=[];t.listOrder=function(e){t.reverse=JSON.stringify(t.predicate)===JSON.stringify(e)&&!t.reverse,t.predicate=e},t.editContact=function(){t.editingContact=!0},t.cancelEditContact=function(){t.editingContact=!1,t.selectContact(t.activeContact.id),t.addingNewContact&&t.removeNewContact()},t.saveEditContact=function(){t.editingContact=!1,t.addingNewContact=!1;var e=t.activeContact.id;for(i in t.list)e===t.list[i].id&&(delete t.activeContact.positionString,t.list[i]=t.activeContact);t.selectContact(t.activeContact.id)},t.encodeAvatar=function(e){var n=(document.querySelector("img"),e[0].files[0]),i=new FileReader;console.log("ENCODING AVATAR..."),i.addEventListener("load",function(){t.$apply(function(){t.activeContact.photo=i.result}),t.saveEditContact()},!1),n&&i.readAsDataURL(n)},t.addNewContact=function(){if(!t.addingNewContact){var e=0;for(i in t.list)e<t.list[i].id&&(e=t.list[i].id);e++,t.list.push({}),t.list[t.list.length-1].id=e,t.selectContact(e),t.editingContact=!0,t.addingNewContact=!0}},t.removeNewContact=function(){t.list.splice(t.list.length-1,1),t.addingNewContact=!1,t.selectContactByIndex(t.filteredListContactIndex-1)},t.deleteContact=function(e){var n=0;if(e=e?e:t.activeContact.id,t.list.length>0){for(i in t.list)e===t.list[i].id&&(n=parseInt(t.filteredListContactIndex),t.list.splice(i,1));t.addingNewContact=!1,t.editingContact=!1,t.$apply(),n<t.filteredList.length-1?t.selectContactByIndex(parseInt(t.filteredListContactIndex)):t.selectContactByIndex(t.filteredList.length-1)}},t.selectContact=function(e){t.editingContact=!1;for(i in t.filteredList)t.filteredList[i].id===e&&(t.filteredListContactIndex=i);for(i in t.list)t.list[i].id===e&&(t.listContactIndex=i);var n=t.list[t.listContactIndex];n=angular.toJson(n,!0),n=JSON.parse(n),t.activeContact=n,t.activeContact.positionString="",t.addingNewContact&&t.removeNewContact(),$(".list-body-wrap").focus()},t.selectContactByIndex=function(e){t.selectContact(t.filteredList[e].id)},t.selectPrevContact=function(){t.filteredListContactIndex>0&&t.selectContactByIndex(parseInt(t.filteredListContactIndex)-1)},t.selectNextContact=function(){t.filteredListContactIndex<t.filteredList.length-1&&t.selectContactByIndex(parseInt(t.filteredListContactIndex)+1)},t.scrollToSelection=function(){var e=$(".list-body-wrap"),n=48,i=e.scrollTop()+e.height()-n,o=48*t.filteredListContactIndex;o>i?e.scrollTop(o-e.height()+n-1):e.scrollTop()>48*t.filteredListContactIndex&&e.scrollTop(48*t.filteredListContactIndex)},t.keyPress=function(e){var n={tab:9,enter:13,esc:27,space:32,left:37,up:38,right:39,down:40,shift:16,ctrl:17,alt:18,backspace:8,del:46,command:91};switch(e.keyCode!=n.up&&e.keyCode!=n.down&&e.keyCode!=n.del&&e.keyCode!=n.backspace||e.preventDefault(),e.keyCode){case n.up:t.selectPrevContact(),t.scrollToSelection();break;case n.down:t.selectNextContact(),t.scrollToSelection();break;case n.del:t.deleteContact(t.activeContact.id);break;case n.backspace:t.deleteContact(t.activeContact.id)}},t.refreshData=function(){t.list=[],a=[],t.list=a},t.printList=function(){window.print()},t.clearContactSearch=function(e){t.contactSearch="",$("#list-search").is(":focus")&&$("#list-search").focus()},t.contactSearchMouseDown=function(t){t.preventDefault()},t.init=function(){if(o.bind(t,"list",a),"undefined"!=typeof t.list&&t.list.length>0)for(i in t.list)"undefined"==typeof t.list[i].fname&&t.list.splice(i,1);else t.list=a;t.isArray=angular.isArray,t.predicate="lname",t.reverse=!1;var e=t.$watch("filteredList",function(){"undefined"!=typeof t.filteredList&&t.filteredList.length>0&&(e(),t.selectContactByIndex(0))})},n.get("/assets/data/contacts.json").success(function(e){a=e;for(i in a)a[i].id=parseInt(i);t.init()})}]);
//# sourceMappingURL=maps/app-0.0.0.min.js.map
